---
import { Code } from "astro:components";
import type { BuiltinLanguage } from "shiki";

interface Props {
  class?: string;
  languages: {
    title: string;
    lang: BuiltinLanguage;
    code: string;
  }[];
}

const { class: className = "", languages = [] } = Astro.props;

/* 
<LanguageVariants
  languages={[
    {
      title: "TypeScript",
      lang: "typescript",
      code: `const foo = 'bar';`,
    },
    {
      title: "Python",
      lang: "python",
      code: `foo = 'bar'`,
    },
  ]}
/>
*/
---

<div
  class={`not-prose rounded-lg border border-gray-200 bg-white p-4 dark:border-gray-700 dark:bg-gray-800 ${className}`}
>
  <div class="mb-4 flex gap-2 border-b border-gray-200 dark:border-gray-700">
    {
      languages.map((lang) => (
        <button
          class="rounded-t-lg px-4 py-2 text-sm font-medium text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"
          data-tab={lang.lang}
        >
          {lang.title}
        </button>
      ))
    }
  </div>
  <div class="min-h-[100px]">
    {
      languages.map((lang) => (
        <div class="hidden" data-content={lang.lang}>
          <Code code={lang.code} lang={lang.lang} />
        </div>
      ))
    }
  </div>
</div>

<script>
  const tabs = document.querySelectorAll<HTMLButtonElement>("[data-tab]");
  const contents = document.querySelectorAll<HTMLDivElement>("[data-content]");

  tabs.forEach((tab) => {
    tab.addEventListener("click", () => {
      // Remove active class from all tabs
      tabs.forEach((t) =>
        t.classList.remove("text-rejot-red-600", "border-b-2", "border-rejot-red-600"),
      );
      // Add active class to clicked tab
      tab.classList.add("text-rejot-red-600", "border-b-2", "border-rejot-red-600");

      // Hide all contents
      contents.forEach((content) => content.classList.add("hidden"));
      // Show selected content
      const content = document.querySelector<HTMLDivElement>(`[data-content="${tab.dataset.tab}"]`);
      if (content) content.classList.remove("hidden");
    });
  });

  // Activate first tab by default
  if (tabs.length > 0) {
    tabs[0].click();
  }
</script>
